<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>WREN AI Companion</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet" />
<style>



main {
  opacity: 0;
  transition: opacity 1.5s ease;
}

main.fade-in {
  opacity: 1;
}
  /* ===== Global Styles ===== */
  html, body {
    margin: 0;
    padding: 0;
    font-family: 'Quicksand', sans-serif;
    background: #f9f9f9;
    height: 100%;
    color: #333;
    transition: background-color 0.5s ease, color 0.5s ease;
  }
  /* Dark mode */
  body.dark-mode {
    background: #121212;
    color: #ddd;
  }
  body.dark-mode main {
    background: linear-gradient(to right, #222, #333);
    color: #eee;
    box-shadow: 0 0 20px rgba(255, 255, 255, 0.1);
  }

  /* ===== Intro Screen ===== */
  #introScreen {
    position: fixed;
    z-index: 9999;
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    background: black;
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    transition: opacity 1.5s ease;
  }
  #introText {
    text-align: center;
    position: relative;
    margin-top: 40px;
  }
  #introLine1 {
    font-size: 1.4rem;
    margin: 0 0 8px 0;
    opacity: 0;
    animation: fadeIn 2s forwards 0.5s;
    line-height: 1.2;
    font-weight: 400;
    color: #ccc;
    user-select: none;
  }
  #introLine2 {
    font-size: 2.2rem;
    font-weight: 900;
    color: white;
    text-shadow:
      0 0 5px white,
      0 0 10px white,
      0 0 20px white,
      0 0 30px white;
    opacity: 0;
    animation:
      fadeIn 2s forwards 2.5s,
      wrenGlow 3s infinite ease-in-out 4.5s;
    position: relative;
    line-height: 1.1;
    user-select: none;
    text-align: center;
    letter-spacing: 0.06em;
  }
  @keyframes wrenGlow {
    0%, 100% {
      text-shadow:
        0 0 5px white,
        0 0 10px white,
        0 0 20px white,
        0 0 30px white;
      color: white;
    }
    50% {
      text-shadow:
        0 0 2px white,
        0 0 6px white,
        0 0 10px white;
      color: white;
    }
  }

  #introStar {
    display: block;
    margin: 20px auto 0;
    width: 60px;
    height: 60px;
    opacity: 0;
    animation: fadeIn 2s forwards 3.5s, starPulse 3s infinite ease-in-out 5s;
  }
  @keyframes starPulse {
    0%, 100% {
      fill: #1e88e5;
      opacity: 1;
    }
    50% {
      fill: #1e88e5;
      opacity: 0.7;
    }
  }

  /* Eyes */
  .eyes {
    position: absolute;
    top: -80px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 24px;
    animation: fadeIn 2s forwards 1.5s;
    user-select: none;
    pointer-events: none;
    width: 80px;
    justify-content: center;
  }
  .eye {
    width: 20px;
    height: 20px;
    background: white;
    border-radius: 50%;
    animation: blink 4s infinite;
  }
  .eye:nth-child(2) {
    animation-delay: 2s;
  }
  @keyframes blink {
    0%, 90%, 100% {
      height: 20px;
    }
    95% {
      height: 2px;
    }
  }
  @keyframes fadeIn {
    to { opacity: 1; }
  }

  /* Fade out intro */
  #introScreen.fade-out {
    opacity: 0;
    pointer-events: none;
  }

  /* ===== Main App Styles ===== */
  body main {
    display: none;
    max-width: 700px;
    margin: 40px auto 60px auto;
    padding: 30px 25px;
    background: linear-gradient(to right, #e3f2fd, #fbe9e7);
    border-radius: 16px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
    color: #333;
    box-sizing: border-box;
    min-height: 300px;
    transition: background 0.5s ease, color 0.5s ease, box-shadow 0.5s ease;
  }
  h1 {
    text-align: center;
    color: #2c3e50;
    margin-bottom: 25px;
    user-select: none;
  }
  label {
    margin-top: 18px;
    display: block;
    font-weight: 600;
    font-size: 1rem;
    color: #444;
    user-select: none;
  }
  input, select {
    padding: 12px 15px;
    margin-top: 8px;
    width: 100%;
    font-size: 1rem;
    border: 1px solid #ccc;
    border-radius: 8px;
    box-sizing: border-box;
    transition: border-color 0.3s ease;
    background: white;
    color: #333;
  }
  input:focus, select:focus {
    outline: none;
    border-color: #4caf50;
    box-shadow: 0 0 8px rgba(76, 175, 80, 0.4);
  }
  button {
    padding: 14px 0;
    font-size: 1.1rem;
    width: 100%;
    margin-top: 22px;
    background-color: #4caf50;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    transition: background-color 0.3s ease;
    user-select: none;
  }
  button:hover:not(:disabled) {
    background-color: #388e3c;
  }
  button:disabled {
    background-color: #a5d6a7;
    cursor: wait;
  }
  #response, #modeResponse {
    margin-top: 22px;
    background: #fff;
    padding: 20px;
    border-radius: 12px;
    box-shadow: inset 0 0 5px rgba(0,0,0,0.05);
    white-space: pre-wrap;
    min-height: 2.2em;
    font-size: 1rem;
    color: #222;
    user-select: text;
    transition: background 0.5s ease, color 0.5s ease;
  }
  #modeSection {
    display: none;
    margin-top: 32px;
  }
  #bookCategoryGroup {
    display: none;
    margin-top: 18px;
  }
  #modeInstructions {
    margin-top: 8px;
    font-size: 0.9rem;
    color: #555;
    min-height: 10em;
    font-style: italic;
    white-space: pre-wrap;
    transition: color 0.5s ease;
  }
  #translationOptions {
    margin-top: 18px;
    padding: 12px 15px;
    background: #f0f4f8;
    border-radius: 10px;
    display: none;
    user-select: none;
    transition: background 0.5s ease, color 0.5s ease;
  }
  #translationOptions label {
    font-weight: normal;
    margin-right: 20px;
    cursor: pointer;
  }
  #translationOptions select {
    width: auto;
    display: inline-block;
    margin-left: 8px;
    font-size: 1rem;
    cursor: pointer;
  }
  /* Dark mode input/select/response backgrounds */
  body.dark-mode input, 
  body.dark-mode select, 
  body.dark-mode #response, 
  body.dark-mode #modeResponse, 
  body.dark-mode #translationOptions {
    background: #222;
    color: #ddd;
    border-color: #555;
  }
  body.dark-mode #modeInstructions {
    color: #ccc;
  }

  /* Language selector style */
  #languageSelector {
    max-width: 700px;
    margin: 24px auto 0 auto;
    padding: 0 25px;
    user-select: none;
  }
  #languageSelector label {
    font-weight: 600;
    font-size: 1rem;
    color: #444;
    margin-right: 12px;
  }
  #languageSelector select {
    padding: 8px 12px;
    font-size: 1rem;
    border-radius: 6px;
    border: 1px solid #ccc;
    cursor: pointer;
    transition: border-color 0.3s ease;
  }
  #languageSelector select:focus {
    outline: none;
    border-color: #4caf50;
  }
</style>
</head>
<body>

<!-- ========== INTRO SCREEN ========== -->
<div id="introScreen">
  <div class="eyes">
    <div class="eye"></div>
    <div class="eye"></div>
  </div>
  <div id="introText">
    <div id="introLine1">Hello there, friend</div>
    <div id="introLine2">I'm WREN</div>
    <!-- Star SVG -->
    <svg id="introStar" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="60" height="60" aria-hidden="true" focusable="false">
      <polygon points="32,4 39,24 60,24 42,38 48,60 32,46 16,60 22,38 4,24 25,24" fill="#1e88e5"/>
    </svg>
  </div>
</div>

<!-- ========== LANGUAGE SELECTOR ======= -->
<div id="languageSelector">
  <label for="languageSelect">üåê Language:</label>
  <select id="languageSelect" aria-label="Select UI language">
    <option value="en" selected>English</option>
    <option value="es">Espa√±ol</option>
    <option value="fr">Fran√ßais</option>
  </select>
</div>

<!-- ========== MAIN APP ========== -->
<main>
  <h1 id="mainTitle">üëã Meet WREN ‚Äî Your AI Companion</h1>

  <!-- Dark Mode Toggle -->
  <label style="user-select:none; margin-bottom: 10px;" id="darkModeLabel">
    <input type="checkbox" id="darkModeToggle" /> Toggle Dark Mode
  </label>

  <label for="nameInput" id="nameLabel">üìù Enter your name:</label>
  <input type="text" id="nameInput" placeholder="Your name here..." autocomplete="off" />
  <button id="startBtn" type="button">Start</button>

  <div id="response"></div>

  <div id="modeSection">
    <label for="modeInput" id="modeLabel">üéØ Choose a Mode:</label>
    <select id="modeInput" aria-describedby="modeInstructions">
      <option value="">-- Select a Mode --</option>
      <option value="1">ü§ñ Name Recognition</option>
      <option value="math">üßÆ Math Problem Solver</option>
      <option value="science">üî¨ Science Explainer</option>
      <option value="3">üìö Book Recommender</option>
      <option value="4">üß≥ Travel Guide</option>
      <option value="5">üí° Creative Writing</option>
      <option value="6">üéµ Music Suggestion</option>
      <option value="7">üé® Art & Design</option>
      <option value="8">üíª Programming Help</option>
      <option value="9">üó£ Language Translation</option>
    </select>

    <div id="modeInstructions"></div>

    <div id="bookCategoryGroup">
      <label for="bookCategory" id="bookCategoryLabel">Choose a book category:</label>
      <select id="bookCategory">
        <option value="">-- Select a Category --</option>
        <option value="fiction">Fiction</option>
        <option value="nonfiction">Non-fiction</option>
        <option value="science">Science</option>
        <option value="history">History</option>
        <option value="fantasy">Fantasy</option>
        <option value="mystery">Mystery</option>
        <option value="selfhelp">Self-help</option>
      </select>
    </div>

    <div id="translationOptions">
      <label for="translateFrom" id="translateFromLabel">From:</label>
      <select id="translateFrom">
        <option value="auto">Auto Detect</option>
        <option value="en">English</option>
        <option value="es">Spanish</option>
        <option value="fr">French</option>
        <option value="de">German</option>
        <option value="zh">Chinese</option>
        <option value="ja">Japanese</option>
      </select>

      <label for="translateTo" id="translateToLabel">To:</label>
      <select id="translateTo">
        <option value="en">English</option>
        <option value="es">Spanish</option>
        <option value="fr">French</option>
        <option value="de">German</option>
        <option value="zh">Chinese</option>
        <option value="ja">Japanese</option>
      </select>
    </div>

    <button id="sendBtn" type="button" disabled>Send</button>

    <div id="modeResponse"></div>
  </div>
</main>

<script>


window.addEventListener('load', () => {
    const intro = document.getElementById('introScreen');
    const main = document.querySelector('main');

    setTimeout(() => {
      intro.classList.add('fade-out'); // triggers CSS transition

      // After fade completes (1.5s), remove intro & show main
      setTimeout(() => {
        intro.style.display = 'none';
        main.style.display = 'block';
        main.classList.add('fade-in');
      }, 1500);
    }, 7000); // delay before fading out (adjust if needed)
  });

  // (keeping your existing script untouched above)

  // === START button handler (new) ===
  const startBtn = document.getElementById('startBtn');
  const responseDiv = document.getElementById('response');
  const modeSection = document.getElementById('modeSection');

  startBtn.addEventListener('click', async () => {
    const name = nameInput.value.trim();
    if (!name) {
      responseDiv.textContent = "Please enter your name first.";
      return;
    }
    startBtn.disabled = true;
    responseDiv.textContent = "Starting...";

    try {
      const res = await fetch("/start", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name })
      });
      const data = await res.json();

      if (data.success) {
        responseDiv.textContent = data.greeting + "\n" + data.intro;
        modeSection.style.display = "block"; // show modes after start
      } else {
        responseDiv.textContent = "Failed to start session.";
      }
    } catch (err) {
      responseDiv.textContent = "Error connecting to server.";
      console.error(err);
    } finally {
      startBtn.disabled = false;
    }
  });
</script>

</body>
</html>